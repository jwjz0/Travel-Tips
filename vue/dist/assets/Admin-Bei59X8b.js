/* empty css             *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css              *//* empty css                *//* empty css                     *//* empty css                 *//* empty css               */import{r as F,a as T,B as j,c as R,b as f,d as o,u as g,C as w,D as G,w as r,E as H,G as K,H as L,I as Q,J as W,y as n,g as X,o as k,f as d,K as Y,k as Z,l as ee,L as le,M as oe,N as te,O as x}from"./index-BhvLEkWq.js";import{r as c}from"./request-DstbRXb0.js";const ae={style:{"background-color":"#e9f9fd"}},re={class:"card",style:{"margin-bottom":"5px"}},ne={class:"card",style:{"margin-bottom":"5px"}},se={class:"card",style:{"margin-bottom":"5px"}},ie={class:"dialog-footer"},xe={__name:"Admin",setup(me){const e=F({user:JSON.parse(localStorage.getItem("user")||" {}"),tableData:[],username:null,name:null,phone:null,email:null,pageNum:1,pageSize:5,total:0,formVisible:!1,form:{},rules:{username:[{required:!0,message:"请填写账号",trigger:"blur"}],name:[{required:!0,message:"请填写名称",trigger:"blur"}],phone:[{required:!0,message:"请填写电话",trigger:"blur"}],email:[{required:!0,message:"请填写邮箱",trigger:"blur"}]},rows:[],ids:[]}),b=T(),s=()=>{e.user.role!=="ADMIN"&&(n.error("权限不足"),X.push("/front")),c.get("admin/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name,username:e.username,phone:e.phone,email:e.email}}).then(a=>{a.code==="200"?(e.tableData=a.data.list,e.total=a.data.total):n.error(a.msg)})};s();const v=()=>{e.name=null,e.username=null,s()},C=()=>{e.formVisible=!0,e.form={}},h=()=>{b.value.validate(a=>{a&&c.post("admin/add",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,n.success("新增成功"),s()):n.error(l.msg)})})},E=a=>{e.form=JSON.parse(JSON.stringify(a)),e.formVisible=!0},S=()=>{b.value.validate(a=>{a&&c.put("admin/update",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,n.success("修改成功"),s()):n.error(l.msg)})})},N=()=>{e.form.id?S():h()},U=a=>{x.confirm("删除后与无法恢复，您确认删除吗？","确认删除",{type:"warning"}).then(l=>{c.delete("/admin/delete/"+a).then(m=>{m.code==="200"?(n.success("删除成功"),s()):n.error(m.msg)})}).catch(l=>{})},z=a=>{e.rows=a,e.ids=e.rows.map(l=>l.id)},B=()=>{if(e.rows.length===0){n.warning("请选择数据");return}x.confirm("删除后与无法恢复，您确认删除吗？","确认删除",{type:"warning"}).then(a=>{c.delete("admin/deleteBatch",{data:e.rows}).then(l=>{l.code==="200"?(n.success("批量删除成功"),s()):n.error(l.msg)})}).catch(a=>{})},$=()=>{let a=e.ids.join(","),l=_+`/admin/export?username=${e.username===null?"":e.username}&name=${e.name===null?"":e.name}&ids=${a}&token=${e.user.token}`;window.open(l)},{appContext:y}=j(),_=y==null?void 0:y.config.globalProperties.$baseUrl,D=a=>{a.code==="200"?(n.success("批量导入成功"),s()):n.error(a.msg)},I=a=>{e.form.avatar=a.data};return(a,l)=>{const m=G,i=H,V=K,u=Y,q=le,J=L,M=Q,p=te,O=oe,P=W;return k(),R("div",ae,[f("div",re,[o(m,{clearable:"",onClear:s,style:{width:"240px","margin-right":"5px"},modelValue:e.name,"onUpdate:modelValue":l[0]||(l[0]=t=>e.name=t),"prefix-icon":g(w),placeholder:"请输入名称查询"},null,8,["modelValue","prefix-icon"]),o(m,{clearable:"",onClear:s,style:{width:"240px","margin-right":"5px"},modelValue:e.username,"onUpdate:modelValue":l[1]||(l[1]=t=>e.username=t),"prefix-icon":g(w),placeholder:"请输入账号查询"},null,8,["modelValue","prefix-icon"]),o(i,{type:"primary",onClick:s},{default:r(()=>l[10]||(l[10]=[d("查 询")])),_:1}),o(i,{onClick:v},{default:r(()=>l[11]||(l[11]=[d("重 置")])),_:1})]),f("div",ne,[o(i,{type:"danger",onClick:C},{default:r(()=>l[12]||(l[12]=[d("新 增")])),_:1}),o(i,{type:"success",onClick:B},{default:r(()=>l[13]||(l[13]=[d("批量删除")])),_:1}),o(i,{type:"info",onClick:$},{default:r(()=>l[14]||(l[14]=[d("批量导出")])),_:1}),o(V,{style:{display:"inline-block","margin-left":"10px"},action:g(_)+"/admin/import","show-file-list":!1,"on-success":D},{default:r(()=>[o(i,{type:"warning"},{default:r(()=>l[15]||(l[15]=[d("批量导入")])),_:1})]),_:1},8,["action"])]),f("div",se,[o(J,{data:e.tableData,style:{width:"100%"},onSelectionChange:z,"header-cell-style":{color:"#333",backgroundColor:"#eaf4ff"}},{default:r(()=>[o(u,{type:"selection",width:"55"}),o(u,{label:"头像"},{default:r(t=>[t.row.avatar?(k(),Z(q,{key:0,"preview-src-list":[t.row.avatar],"preview-teleported":!0,src:t.row.avatar,style:{width:"40px",height:"40px","border-radius":"50%",display:"block"}},null,8,["preview-src-list","src"])):ee("",!0)]),_:1}),o(u,{prop:"username",label:"账号"}),o(u,{prop:"name",label:"名称"}),o(u,{prop:"phone",label:"电话"}),o(u,{prop:"email",label:"邮箱"}),o(u,{label:"操作",width:"100"},{default:r(t=>[o(i,{type:"primary",circle:"",icon:"Edit",onClick:A=>E(t.row)},null,8,["onClick"]),o(i,{type:"danger",circle:"",icon:"Delete",onClick:A=>U(t.row.id)},null,8,["onClick"])]),_:1})]),_:1},8,["data"])]),f("div",null,[o(M,{"current-page":e.pageNum,"onUpdate:currentPage":l[2]||(l[2]=t=>e.pageNum=t),"page-size":e.pageSize,"onUpdate:pageSize":l[3]||(l[3]=t=>e.pageSize=t),layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,20],total:e.total,onCurrentChange:s,onSizeChange:s},null,8,["current-page","page-size","total"])]),o(P,{title:"管理员信息",modelValue:e.formVisible,"onUpdate:modelValue":l[9]||(l[9]=t=>e.formVisible=t),width:"40%","destroy-on-close":""},{footer:r(()=>[f("div",ie,[o(i,{onClick:l[8]||(l[8]=t=>e.formVisible=!1)},{default:r(()=>l[17]||(l[17]=[d("取消")])),_:1}),o(i,{type:"primary",onClick:N},{default:r(()=>l[18]||(l[18]=[d("保 存")])),_:1})])]),default:r(()=>[o(O,{ref_key:"formRef",ref:b,model:e.form,rules:e.rules,"label-width":"80px",style:{padding:"20px 30px 30px 0"}},{default:r(()=>[o(p,{prop:"username",label:"账号"},{default:r(()=>[o(m,{modelValue:e.form.username,"onUpdate:modelValue":l[4]||(l[4]=t=>e.form.username=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{prop:"name",label:"名称"},{default:r(()=>[o(m,{modelValue:e.form.name,"onUpdate:modelValue":l[5]||(l[5]=t=>e.form.name=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{prop:"phone",label:"电话"},{default:r(()=>[o(m,{modelValue:e.form.phone,"onUpdate:modelValue":l[6]||(l[6]=t=>e.form.phone=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{prop:"email",label:"邮箱"},{default:r(()=>[o(m,{modelValue:e.form.email,"onUpdate:modelValue":l[7]||(l[7]=t=>e.form.email=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{prop:"avatar",label:"头像"},{default:r(()=>[o(V,{action:g(_)+"/files/upload",headers:{token:e.user.token},"on-success":I,"list-type":"picture"},{default:r(()=>[o(i,{type:"primary"},{default:r(()=>l[16]||(l[16]=[d("上传头像")])),_:1})]),_:1},8,["action","headers"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{xe as default};
