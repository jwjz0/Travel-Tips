/* empty css             *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css              *//* empty css                *//* empty css                     *//* empty css                 *//* empty css               */import{r as T,a as j,B as R,c as A,b as f,d as t,u as g,C as w,D as G,w as r,E as H,G as K,H as L,I as Q,J as W,y as s,o as x,f as u,K as X,k as Y,l as Z,L as ee,M as le,N as te,O as k}from"./index-BhvLEkWq.js";import{r as c}from"./request-DstbRXb0.js";const oe={class:"card",style:{"margin-bottom":"5px"}},ae={class:"card",style:{"margin-bottom":"5px"}},re={class:"card",style:{"margin-bottom":"5px"}},ne={class:"dialog-footer"},we={__name:"User",setup(se){const e=T({user:JSON.parse(localStorage.getItem("user")||" {}"),tableData:[],username:null,name:null,phone:null,email:null,pageNum:1,pageSize:5,total:0,formVisible:!1,form:{},rules:{username:[{required:!0,message:"请填写账号",trigger:"blur"}],name:[{required:!0,message:"请填写名称",trigger:"blur"}],phone:[{required:!0,message:"请填写电话",trigger:"blur"}],email:[{required:!0,message:"请填写邮箱",trigger:"blur"}]},rows:[],ids:[]}),b=j(),{appContext:y}=R(),V=y==null?void 0:y.config.globalProperties.$baseUrl,n=()=>{c.get("user/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name,username:e.username,phone:e.phone,email:e.email}}).then(a=>{a.code==="200"?(e.tableData=a.data.list,e.total=a.data.total):s.error(a.msg)})};n();const v=()=>{e.name=null,e.username=null,n()},C=()=>{e.formVisible=!0,e.form={}},h=()=>{b.value.validate(a=>{a&&c.post("user/add",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,s.success("新增成功"),n()):s.error(l.msg)})})},E=a=>{e.form=JSON.parse(JSON.stringify(a)),e.formVisible=!0},S=()=>{b.value.validate(a=>{a&&c.put("user/update",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,s.success("修改成功"),n()):s.error(l.msg)})})},N=()=>{e.form.id?S():h()},U=a=>{k.confirm("删除后与无法恢复，您确认删除吗？","确认删除",{type:"warning"}).then(l=>{c.delete("/user/delete/"+a).then(m=>{m.code==="200"?(s.success("删除成功"),n()):s.error(m.msg)})}).catch(l=>{})},z=a=>{e.rows=a,e.ids=e.rows.map(l=>l.id)},B=()=>{if(e.rows.length===0){s.warning("请选择数据");return}k.confirm("删除后与无法恢复，您确认删除吗？","确认删除",{type:"warning"}).then(a=>{c.delete("user/deleteBatch",{data:e.rows}).then(l=>{l.code==="200"?(s.success("批量删除成功"),n()):s.error(l.msg)})}).catch(a=>{})},$=()=>{let a=e.ids.join(","),l=V+`/user/export?username=${e.username===null?"":e.username}&name=${e.name===null?"":e.name}&ids=${a}&token=${e.user.token}`;window.open(l)},D=a=>{a.code==="200"?(s.success("批量导入成功"),n()):s.error(a.msg)},I=a=>{e.form.avatar=a.data};return(a,l)=>{const m=G,i=H,_=K,d=X,q=ee,J=L,O=Q,p=te,P=le,F=W;return x(),A("div",null,[f("div",oe,[t(m,{clearable:"",onClear:n,style:{width:"240px","margin-right":"5px"},modelValue:e.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.name=o),"prefix-icon":g(w),placeholder:"请输入名称查询"},null,8,["modelValue","prefix-icon"]),t(m,{clearable:"",onClear:n,style:{width:"240px","margin-right":"5px"},modelValue:e.username,"onUpdate:modelValue":l[1]||(l[1]=o=>e.username=o),"prefix-icon":g(w),placeholder:"请输入账号查询"},null,8,["modelValue","prefix-icon"]),t(i,{type:"primary",onClick:n},{default:r(()=>l[10]||(l[10]=[u("查 询")])),_:1}),t(i,{onClick:v},{default:r(()=>l[11]||(l[11]=[u("重 置")])),_:1})]),f("div",ae,[t(i,{type:"danger",onClick:C},{default:r(()=>l[12]||(l[12]=[u("新 增")])),_:1}),t(i,{type:"success",onClick:B},{default:r(()=>l[13]||(l[13]=[u("批量删除")])),_:1}),t(i,{type:"info",onClick:$},{default:r(()=>l[14]||(l[14]=[u("批量导出")])),_:1}),t(_,{style:{display:"inline-block","margin-left":"10px"},action:g(V)+"/user/import","show-file-list":!1,"on-success":D},{default:r(()=>[t(i,{type:"warning"},{default:r(()=>l[15]||(l[15]=[u("批量导入")])),_:1})]),_:1},8,["action"])]),f("div",re,[t(J,{data:e.tableData,style:{width:"100%"},onSelectionChange:z,"header-cell-style":{color:"#333",backgroundColor:"#eaf4ff"}},{default:r(()=>[t(d,{type:"selection",width:"55"}),t(d,{label:"头像"},{default:r(o=>[o.row.avatar?(x(),Y(q,{key:0,"preview-src-list":[o.row.avatar],"preview-teleported":!0,src:o.row.avatar,style:{width:"40px",height:"40px","border-radius":"50%",display:"block"}},null,8,["preview-src-list","src"])):Z("",!0)]),_:1}),t(d,{prop:"username",label:"账号"}),t(d,{prop:"name",label:"名称"}),t(d,{prop:"phone",label:"电话"}),t(d,{prop:"email",label:"邮箱"}),t(d,{label:"操作",width:"100"},{default:r(o=>[t(i,{type:"primary",circle:"",icon:"Edit",onClick:M=>E(o.row)},null,8,["onClick"]),t(i,{type:"danger",circle:"",icon:"Delete",onClick:M=>U(o.row.id)},null,8,["onClick"])]),_:1})]),_:1},8,["data"])]),f("div",null,[t(O,{"current-page":e.pageNum,"onUpdate:currentPage":l[2]||(l[2]=o=>e.pageNum=o),"page-size":e.pageSize,"onUpdate:pageSize":l[3]||(l[3]=o=>e.pageSize=o),layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,20],total:e.total,onCurrentChange:n,onSizeChange:n},null,8,["current-page","page-size","total"])]),t(F,{title:"普通用户信息",modelValue:e.formVisible,"onUpdate:modelValue":l[9]||(l[9]=o=>e.formVisible=o),width:"40%","destroy-on-close":""},{footer:r(()=>[f("div",ne,[t(i,{onClick:l[8]||(l[8]=o=>e.formVisible=!1)},{default:r(()=>l[17]||(l[17]=[u("取消")])),_:1}),t(i,{type:"primary",onClick:N},{default:r(()=>l[18]||(l[18]=[u("保 存")])),_:1})])]),default:r(()=>[t(P,{ref_key:"formRef",ref:b,model:e.form,rules:e.rules,"label-width":"80px",style:{padding:"20px 30px 30px 0"}},{default:r(()=>[t(p,{prop:"username",label:"账号"},{default:r(()=>[t(m,{modelValue:e.form.username,"onUpdate:modelValue":l[4]||(l[4]=o=>e.form.username=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(p,{prop:"name",label:"名称"},{default:r(()=>[t(m,{modelValue:e.form.name,"onUpdate:modelValue":l[5]||(l[5]=o=>e.form.name=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(p,{prop:"phone",label:"电话"},{default:r(()=>[t(m,{modelValue:e.form.phone,"onUpdate:modelValue":l[6]||(l[6]=o=>e.form.phone=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(p,{prop:"email",label:"邮箱"},{default:r(()=>[t(m,{modelValue:e.form.email,"onUpdate:modelValue":l[7]||(l[7]=o=>e.form.email=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(p,{prop:"avatar",label:"头像"},{default:r(()=>[t(_,{action:g(V)+"/files/upload",headers:{token:e.user.token},"on-success":I,"list-type":"picture"},{default:r(()=>[t(i,{type:"primary"},{default:r(()=>l[16]||(l[16]=[u("上传头像")])),_:1})]),_:1},8,["action","headers"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{we as default};
