/* empty css             *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css              *//* empty css                *//* empty css               */import{a as M,r as J,c as O,b as m,d as o,u as _,C as V,D as q,w as r,E as A,k as y,l as x,H as P,I as T,J as $,y as d,o as c,f as p,K as h,M as F,N as R,O as j}from"./index-BhvLEkWq.js";import{r as f}from"./request-DstbRXb0.js";const H={class:"card",style:{"margin-bottom":"5px"}},K={class:"card",style:{"margin-bottom":"5px"}},G={class:"card",style:{"margin-bottom":"5px"}},L={class:"dialog-footer"},ne={__name:"Notice",setup(Q){const g=M({}),e=J({user:JSON.parse(localStorage.getItem("user")),title:null,content:null,pageNum:1,pageSize:5,total:0,tableData:[],form:{},formVisible:!1,rules:{title:[{required:!0,message:"请填写公告",trigger:"blur"}],content:[{required:!0,message:"请填写内容",trigger:"blur"}]}}),n=()=>{f.get("/notice/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,total:e.total,title:e.title,content:e.content}}).then(l=>{var t,i;l.code==="200"?(e.tableData=(t=l.data)==null?void 0:t.list,e.total=(i=l.data)==null?void 0:i.total):d.error(l.msg)})};n();const C=()=>{e.form={},e.formVisible=!0},k=l=>{e.form=JSON.parse(JSON.stringify(l)),e.formVisible=!0},N=()=>{f.post("/notice/add",e.form).then(l=>{l.code==="200"?(d.success("新增成功"),e.formVisible=!1,n()):d.error(l.msg)})},v=()=>{f.put("/notice/update",e.form).then(l=>{l.code==="200"?(d.success("更新成功"),e.formVisible=!1,n()):d.error(l.msg)})},E=()=>{g.value.validate(l=>{l&&(e.form.id?v():N())})},w=l=>{j.confirm("删除后与无法恢复，您确认删除吗？","确认删除",{type:"warning"}).then(t=>{f.delete("/notice/delete/"+l).then(i=>{i.code==="200"?(d.success("删除成功"),n()):d.error(i.msg)})}).catch(t=>{})},z=()=>{e.title=null,e.content=null,n()};return(l,t)=>{const i=q,s=A,u=h,S=P,D=T,b=R,U=F,B=$;return c(),O("div",null,[m("div",H,[o(i,{clearable:"",onClear:n,style:{width:"240px","margin-right":"5px"},modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=a=>e.title=a),"prefix-icon":_(V),placeholder:"请输入公告标题查询"},null,8,["modelValue","prefix-icon"]),o(i,{clearable:"",onClear:n,style:{width:"240px","margin-right":"5px"},modelValue:e.content,"onUpdate:modelValue":t[1]||(t[1]=a=>e.content=a),"prefix-icon":_(V),placeholder:"请输入公告内容查询"},null,8,["modelValue","prefix-icon"]),o(s,{type:"primary",onClick:n},{default:r(()=>t[8]||(t[8]=[p("查 询")])),_:1}),o(s,{onClick:z},{default:r(()=>t[9]||(t[9]=[p("重 置")])),_:1})]),m("div",K,[e.user.role==="ADMIN"?(c(),y(s,{key:0,type:"info",onClick:C},{default:r(()=>t[10]||(t[10]=[p("新 增")])),_:1})):x("",!0)]),m("div",G,[o(S,{data:e.tableData,style:{width:"100%"},"header-cell-style":{color:"#333",backgroundColor:"#eaf4ff"}},{default:r(()=>[o(u,{prop:"title",label:"公告标题"}),o(u,{prop:"content",label:"公告内容"}),o(u,{prop:"time",label:"时间"}),e.user.role==="ADMIN"?(c(),y(u,{key:0,label:"操作",width:"100"},{default:r(a=>[o(s,{type:"primary",circle:"",icon:"Edit",onClick:I=>k(a.row)},null,8,["onClick"]),o(s,{type:"danger",circle:"",icon:"Delete",onClick:I=>w(a.row.id)},null,8,["onClick"])]),_:1})):x("",!0)]),_:1},8,["data"])]),m("div",null,[o(D,{"current-page":e.pageNum,"onUpdate:currentPage":t[2]||(t[2]=a=>e.pageNum=a),"page-size":e.pageSize,"onUpdate:pageSize":t[3]||(t[3]=a=>e.pageSize=a),layout:"total, sizes, prev, pager, next, jumper","page-sizes":[5,10,20],total:e.total,onCurrentChange:n,onSizeChange:n},null,8,["current-page","page-size","total"])]),o(B,{title:"公告信息",modelValue:e.formVisible,"onUpdate:modelValue":t[7]||(t[7]=a=>e.formVisible=a),width:"40%","destroy-on-close":""},{footer:r(()=>[m("div",L,[o(s,{onClick:t[6]||(t[6]=a=>e.formVisible=!1)},{default:r(()=>t[11]||(t[11]=[p("取消")])),_:1}),o(s,{type:"primary",onClick:E},{default:r(()=>t[12]||(t[12]=[p("保 存")])),_:1})])]),default:r(()=>[o(U,{ref_key:"formRef",ref:g,model:e.form,rules:e.rules,"label-width":"80px",style:{padding:"20px 30px 30px 0"}},{default:r(()=>[o(b,{prop:"title",label:"公告标题"},{default:r(()=>[o(i,{modelValue:e.form.title,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.title=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(b,{prop:"content",label:"公告内容"},{default:r(()=>[o(i,{type:"textarea",rows:3,modelValue:e.form.content,"onUpdate:modelValue":t[5]||(t[5]=a=>e.form.content=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{ne as default};
